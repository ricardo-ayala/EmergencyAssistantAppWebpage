<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!--
Design by Free CSS Templates
http://www.freecsstemplates.org
Released for free under a Creative Commons Attribution 2.5 License

Name       : Breakeven 
Description: A two-column, fixed-width design with dark color scheme.
Version    : 1.0
Released   : 20130509

-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="keywords" content="" />
<meta name="description" content="" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>History</title>
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css" />
<link href='http://fonts.googleapis.com/css?family=Abel|Satisfy' rel='stylesheet' type='text/css'>
<link href="style.css" rel="stylesheet" type="text/css" media="screen" />

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script type="text/javascript" src="http://www.json.org/json2.js"></script>

<script>
<!-----------Transforms a String Object to a JSON Object--------->
$.fn.serializeObject = function()
{
    var o = {};
    var a = this.serializeArray();
    $.each(a, function() {
        if (o[this.name] !== undefined) {
            if (!o[this.name].push) {
                o[this.name] = [o[this.name]];
            }
            o[this.name].push(this.value || '');
        } else {
            o[this.name] = this.value || '';
        }
    });
    return o;
};

<!-----------Changes Sidebar from show to add Emergency-------->

$(function(){
  $("#change").click(function(){
    $("#sidebar1").css("display","none");
    $("#sidebar2").css("display","inline");
  });
});

<!------------------Adds a Client with an Emergency to Local Storage--------------->
$(function() {
    $('#add').submit(function() {
        
		var key = $('#clientPhoneNumber').val();
		var timestamp = new Date();
		var JSONObject = JSON.stringify($('#add').serializeObject());
		$('#timeStamp').val(timestamp);
		localStorage.setItem( key , JSONObject );
		
		
<!---------------Adds the Emergency Information to the Active Emergencies container------>    		
		var texto = JSON.parse(JSONObject).clientName + ", " +JSON.parse(JSONObject).clientPhoneNumber + ", " +JSON.parse(JSONObject).attendedBy;
		
		var valor = JSON.parse(JSONObject).clientPhoneNumber + "," 
		          + JSON.parse(JSONObject).clientNombre + "," 
				  + JSON.parse(JSONObject).clientAddress + "," 
                  + JSON.parse(JSONObject).typeOfEmergency + "," 
				  + JSON.parse(JSONObject).outsideHome + "," 
				  + JSON.parse(JSONObject).attendedBy + "," 
				  + JSON.parse(JSONObject).clientNombre + "," 
				  + JSON.parse(JSONObject).emergencyDetails + "," 
				  + JSON.parse(JSONObject).latitude + "," 
				  + JSON.parse(JSONObject).longitude;
		
		var radioBtn = $('<input id=' +key+ ' type="radio" name="active" value='+valor+'>'+texto+'------------------------Active</input><br>');
		$('#active').append(radioBtn);
		
<!--------------Changes HTML Doc to initial state----------------------------------->		
		<!--$('#active').html(JSON.parse(JSONObject).clientName);
		$("#sidebar1").css("display","inline");
		$("#sidebar2").css("display","none");
		
		$('#add').trigger("reset");
		
        return false;
    });
});
<!------------Re-populates de Active Emergencies container if the window is closed or refreshed-------------->
$(window).load(function () {
				var storageElements = localStorage.length;
				
				if (storageElements == 0){
				return false;
				
				}else{
					var i,key,JSONObject;
					var localStorageKeys = Object.keys(localStorage);
					for ( i = 0; i < storageElements; i++){
					key = localStorageKeys[i];
					JSONObject = localStorage.getItem(key);
					
					
					var texto = JSON.parse(JSONObject).clientName + ", " +JSON.parse(JSONObject).clientPhoneNumber + ", " +JSON.parse(JSONObject).attendedBy;
		
					var valor = JSON.parse(JSONObject).clientPhoneNumber + "," 
							  + JSON.parse(JSONObject).clientNombre + "," 
							  + JSON.parse(JSONObject).clientAddress + "," 
							  + JSON.parse(JSONObject).typeOfEmergency + "," 
							  + JSON.parse(JSONObject).outsideHome + "," 
							  + JSON.parse(JSONObject).attendedBy + "," 
							  + JSON.parse(JSONObject).clientNombre + "," 
							  + JSON.parse(JSONObject).emergencyDetails + "," 
							  + JSON.parse(JSONObject).latitude + "," 
							  + JSON.parse(JSONObject).longitude;
		
								var radioBtn = $('<input id=' +key+ ' type="radio" name="active" value='+valor+'>'+texto+'------------------------Active</input><br>');
								$('#active').append(radioBtn);
					
					
					}
				
				}
		return false;
		});

<!--Edits information of an Emergency-->
function editInfo()
{

}

<!--Displays the information of the emergency on screen along with the clients location(map)-->
function showInfo()
{

}

<!--Shares the clients information with another agency-->
function relayInfo()
{

}

<!--------------------------------------------TEST FUNCTIONS ONLY------------------------------------------------------------------------>
$(function(){
	$('#formData').submit(function(){
		
		var dataKey = $('#keyFetcher').val();
		
		var actualStorageSize = JSON.stringify(localStorage).length;
		$('#result').text("KEY = "+ dataKey + " DATA = " + localStorage.getItem(dataKey) + " SIZE = " + actualStorageSize + " Bytes");
		return false;
    })
})

function counterReset()
{
localStorage.clear();
}

</script>

</head>
<body>
<div id="wrapper">
	<div id="header-wrapper">
		<div id="header" class="container">
			<div id="logo">
				<h1><a href="#">Emergency Center</a></h1>
			</div>
			<div id="menu">
				<ul>
					<li><a href="C:\Users\Ricardo\Documents\GitHub\EmergencyAssistantAppWebpage\WebPage\Pages\Active Emergencies Prototype.html">Homepage</a></li>
					<li class="current_page_item"><a href="#">History</a></li>
					<li><a href="#">Account Information</a></li>
					<li><a href="#">Log out</a></li>
					
				</ul>
			</div>
		</div>
	</div>
	<!-- end #header -->
	<div id="page">
		<div id="content">
			<div class="post">
				
				<div class="entry">
				
					<h2>History</h2>
					
					
					
					
					
				</div>
			</div>
		</div>
		<!-- end #content -->
		<div id="sidebar1">
			<ul>
				<li>
					<h2>Filters</h2>
					<ul>
						<li></li>
						<li></li>
						<li></li>
						<li></li>
						<li></li>
						<li></li>
						<li></li>
						<li></li>
						<li></li>
						
					</ul>
				</li>
			</ul>
		</div>
		<!-- end #sidebar -->
		<div style="clear: both;">&nbsp;</div>
	</div>
	<!-- end #page --> 
	
</div>
<div id="footer">
	<p>Copyright (c) 2013 Sitename.com. All rights reserved. Images by <a href="http://fotogrph.com/">Fotogrph</a>. Design by <a href="http://www.freecsstemplates.org/" rel="nofollow">FreeCSSTemplates.org</a>.</p>
</div>
<!-- end #footer -->
</body>
</html>
