<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!--
Design by Free CSS Templates
http://www.freecsstemplates.org
Released for free under a Creative Commons Attribution 2.5 License

Name       : Breakeven 
Description: A two-column, fixed-width design with dark color scheme.
Version    : 1.0
Released   : 20130509

-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="keywords" content="" />
<meta name="description" content="" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>History</title>
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css" />
<link href='http://fonts.googleapis.com/css?family=Abel|Satisfy' rel='stylesheet' type='text/css'>
<link href="style.css" rel="stylesheet" type="text/css" media="screen" />

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

<script>
<!-----------TRANSFORMS a String Object to a JSON Object--------->
$.fn.serializeObject = function()
{
    var o = {};
    var a = this.serializeArray();
    $.each(a, function() {
        if (o[this.name] !== undefined) {
            if (!o[this.name].push) {
                o[this.name] = [o[this.name]];
            }
            o[this.name].push(this.value || '');
        } else {
            o[this.name] = this.value || '';
        }
    });
    return o;
};

$(window).load(function () {
	
	var date = new Date();
	var month = date.getMonth()+1;
	var day = date.getDate();

	var dateFormat = date.getFullYear() + '-' +
			((''+month).length<2 ? '0' : '') + month + '-' +
			((''+day).length<2 ? '0' : '') + day;
	
	$("#date").attr("max", dateFormat);
});
	


$(function () {
$("#go").click(function(){
	$("#history").empty();
	var date = new Date();
	var month = date.getMonth()+1;
	var day = date.getDate();

	var dateFormat = date.getFullYear() + '-' +
			((''+month).length<2 ? '0' : '') + month + '-' +
			((''+day).length<2 ? '0' : '') + day;
	
	var JSONHDate = JSON.stringify($("#historyform").serializeObject());
	if (JSON.parse(JSONHDate).date == ""){
		alert("Please select a date");
		$("#historyform").trigger("reset");
	}
	else{
			var storageElements = localStorage.length;

			if (storageElements == 0){
				alert("There are no records in the DB");
				return false;
				
				}else{
					var i,key,JSONObject;
					var localStorageKeys = Object.keys(localStorage);
					for ( i = 0; i < storageElements; i++){
					key =  localStorageKeys[i];
						
					JSONObject = localStorage.getItem(key);
					
					var timeStamp = JSON.parse(JSONObject).timeStamp;
					
					var JSONDate = timeStamp.split(" ");
					
					
					if( JSONDate[0] == JSON.parse(JSONHDate).date ){
					
					
					var texto = JSON.parse(JSONObject).clientName + ", " +JSON.parse(JSONObject).clientPhoneNumber + ", " +JSON.parse(JSONObject).attendedBy;
				
							
							
					var radioBtn = $('<input id="'+ key +'" type="radio" name="active" value=' + '"'+ key + '"' +'>'+texto+'</input><br>');
					$('#history').append(radioBtn);
							
											
					}
					
					
						
					}
				}
	
		}
		
	return false;
});
});

</script>


</head>
<body>
<div id="wrapper">
	<div id="header-wrapper">
		<div id="header" class="container">
			<div id="logo">
				<h1><a href="#">Emergency Center</a></h1>
			</div>
			<div id="menu">
				<ul>
					<li><a href="C:\Users\Ricardo\Documents\GitHub\EmergencyAssistantAppWebpage\WebPage\Pages\Active Emergencies Prototype.html">Homepage</a></li>
					<li class="current_page_item"><a href="#">History</a></li>
					<li><a href="C:\Users\Ricardo\Documents\GitHub\EmergencyAssistantAppWebpage\WebPage\Pages\Account Settings Prototype.html">Account Settings</a></li>
					<li><a href="C:\Users\Ricardo\Documents\GitHub\EmergencyAssistantAppWebpage\WebPage\Pages\Login Prototype.html">Log out</a></li>
					
				</ul>
			</div>
		</div>
	</div>
	<!-- end #header -->
	<div id="page">
		<div id="content">
			<div class="post">
				
				<div class="entry">
				
					<h2>History</h2>
					<form id="main">
					<div id="history" class="containerHistory">

 					
					</div>
					</form>

					
					
					
					
				</div>
			</div>
		</div>
		<!-- end #content -->
		<div id="sidebar1">
			<ul>
				<li>
					<h2>Filters</h2>
					<ul>
						<form id="historyform" action="" method="post">
						<li> Select a day to view past emergency reports: <input type="date" id="date" name="date" /> </li>
						<button id="go" type="submit" class="more" max="">Submit</button>
						</form>
					</ul>
				</li>
			</ul>
		</div>
		<!-- end #sidebar -->
		<div style="clear: both;">&nbsp;</div>
	</div>
	<!-- end #page --> 
	
</div>
<div id="footer">
	<p>Copyright (c) 2013 Sitename.com. All rights reserved. Images by <a href="http://fotogrph.com/">Fotogrph</a>. Design by <a href="http://www.freecsstemplates.org/" rel="nofollow">FreeCSSTemplates.org</a>.</p>
</div>
<!-- end #footer -->
</body>
</html>
